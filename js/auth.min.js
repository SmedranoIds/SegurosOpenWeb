"use strict";!function(e){e(document).on("submit","#openweb-form-login",function(o){o.preventDefault(),o.stopPropagation(),e("#signon-error-msg").fadeOut();var a=e("#remembermeChk").is(":checked"),t=e("#userNameInput").val(),r=e("#passwordInput").val(),n={url:window.location.protocol+"//"+window.location.hostname+"/auth/users/access"+(a?"?remember_me=true":""),method:"POST",type:"POST",dataType:"json",contentType:"application/json",headers:{authorization:"Basic "+window.btoa(t+":"+r)}};e.ajax(n).done(function(){a&&function(e,o,a){var t=e.trim(),r=new Date;if(t=t+"="+(o="object"==typeof o?JSON.stringify(o):(""+o).trim())+";",a)for(var n in a)o=a[n],"expires"===n?(r.setTime(r.getTime()+24*o*60*60*1e3),t=t+"expires="+r.toUTCString()+";"):t+=n+"="+o+";";else r.setTime(r.getTime()+2592e6),t=t+"expires="+r.toUTCString();document.cookie=t}("bbva_rememberme",!0),window.location.replace("/")}).fail(function(o){e("#signon-error-msg").fadeIn()})}),e(document).on("submit","#openweb-form-register",function(o){o.preventDefault(),o.stopPropagation();var a=e("script[data-bbva-project]");if(1===a.length&&function(){var o=[],a='<div class="error-info"></div>',t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i),r=new RegExp(/(?=^.{8,}$)(?=(.*\d){2})(?=(.*[A-Za-z]){2})(?!.*[ÑñÇç\\s])^.*/);e("#openweb-form-register input").each(function(){""===e(this).val().trim()?(e(this).addClass("error"),e(this).after(e(a).html(e(this).attr("data-msg-err"))),o.push("error")):(e(this).removeClass("error"),e(this).siblings(".error-info").remove())}),e("#email").val().trim().length>1&&!t.test(e("#email").val())&&(e("#email").addClass("error").after(e(a).html(e("#email").attr("data-msg-err-format"))),o.push("error"));var n=e("#password").val().trim();return n!==e("#repeat-password").val().trim()&&(e("#password").addClass("error").after(e(a).html(e("#password").attr("data-msg-err-repeat"))),o.push("error")),n.length>1&&!r.test(n)&&(e("#password").addClass("error").after(e(a).html(e("#password").attr("data-msg-err-format"))),o.push("error")),0===o.length}()){var t={method:"POST",type:"POST",url:window.location.protocol+"//"+window.location.hostname+"/bbva-components/authbbva/?project="+a.attr("data-bbva-project"),dataType:"json",contentType:"application/json"},r={email:e("#email").val(),username:e("#username").val(),password:window.btoa(e("#password").val()),optional_data:{name:e("#name").val(),surname:e("#surname").val()}};t.data=JSON.stringify(r),e.ajax(t).done(function(){e("errorArmadillo").hide(),e("#successArmadillo").show(),e("#openweb-form-register")[0].reset(),e("html, body").stop().animate({scrollTop:e("#successArmadillo").offset().top-50},750)}).fail(function(o){var a=e("#errorArmadillo");a.hide();var t=409===o.status?"data-msg-error-conflict":"data-msg-error-default";a.html(a.children()).append(" "+a.attr(t)),a.show(),e("html, body").stop().animate({scrollTop:a.offset().top-50},750)})}}),e(document).ready(function(){new RegExp("(?:^|;\\s*)"+encodeURIComponent("CloudFront-Signature").replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)&&BbvaComponent.getUserLogged(function(o,a){if(a){console.log(a);var t=" "+a.get("optional_data").name+" "+a.get("optional_data").surname,r=e("#openweb-access-lg").attr("data-logout");e("#openweb-access-lg").remove(),e("#openweb-access-mobile").remove(),e("#login-openweb-lg").append(t),e("#login-openweb-lg").css({display:"block"}),e("#login-openweb-mobile").append(t),e("#login-openweb-mobile").css({display:"inline"}),e("#register").html('<a href="#" id="openweb-user-logout">'+r+"</a>"),e("#openweb-user-logout").on("click",function(){a.logout(function(){window.location.href=window.location.origin})})}})})}(jQuery);